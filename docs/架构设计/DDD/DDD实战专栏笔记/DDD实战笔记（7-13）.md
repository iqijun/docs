# 07丨DDD分层架构：有效降低层与层之间的依赖

1.第4页 【高亮】

在设计和开发时，不要将本该放在领域层的业务逻辑放到应用层中实 现。因为庞大的应用层会使

领域模型失焦，时间一长你的微服务就会演化为传统的三层架 构，业务逻辑会变得混乱。 另外，

应用服务是在应用层的，它负责服务的组合、编排和转发，负责处理业务用例的执行 顺序以及结

果的拼装，以粗粒度的服务通过 API 网关向前端发布。还有，应用服务还可以 进行安全认证、权

限校验、事务控制、发送或订阅领域事件等。

2.第4页 【高亮】

领域层的作用是实现企业核心业务逻辑，通过各种校验手段保证业务的正确性。领域层主要 体现

领域模型的业务能力，它用来表达业务概念、业务状态和业务规则。

3.第4页 【高亮】

首先，领域模型的业务逻辑主要是由实体和领域服务来实现的，其中实体会采用充血模型来 实现

所有与之相关的业务功能。其次，你要知道，实体和领域对象在实现业务逻辑上不是同 级的，当

领域中的某些功能，单一实体（或者值对象）不能实现时，领域服务就会出马，它 可以组合聚合

内的多个实体（或者值对象），实现复杂的业务逻辑。

4.第5页 【高亮】

DDD 分层架构有一个重要的原则：每层只能与位于其下 方的层发生耦合。


# 08丨微服务架构模型：几种常见模型的对比和分析

1.第5页 【高亮】

核心业务逻辑也是有差异的，有的业务逻辑属于领域 模型的能力，有的则属于面向用户的用例和

流程编排能力。按照这种功能的差异，我们在这 三种架构中划分了应用层和领域层，来承担不同

的业务逻辑。 领域层实现面向领域模型，实现领域模型的核心业务逻辑，属于原子模型，它需要

保持领域 模型和业务逻辑的稳定，对外提供稳定的细粒度的领域服务，所以它处于架构的核心位置

2.第5页 【高亮】

应用层实现面向用户操作相关的用例和流程，对外提供粗粒度的 API 服务。它就像一个齿 轮一样

进行前台应用和领域层的适配，接收前台需求，随时做出响应和调整，尽量避免将前 台需求传导

到领域层。应用层作为配速齿轮则位于前台应用和领域层之间

3.第6页 【高亮】

不要把与领域无关的逻辑放在领域层实现，保证领域层的纯洁和领域逻辑的稳定，避免污染 领域

模型。也不要把领域模型的业务逻辑放在应用层，这样会导致应用层过于庞大，最终领 域模型会

失焦。如果实在无法避免，我们可以引入防腐层，进行新老系统的适配和转换，过 渡期完成后，

可以直接将防腐层代码抛弃

4.第6页 【高亮】

项目级微服务

5.第6页 【高亮】

企业级中台微服务



# 09丨中台：数字转型后到底应该共享什么？

1.第2页 【高亮】

阿里业务中台的目标是把核心服务链 路（会员、商品、交易、营销、店铺、资金结算等）整体当

作一个平台产品来做，为前端业 务提供的是业务解决方案，而不是彼此独立的系统。

2.第3页 【高亮】

我们可以提炼出几个关于中台的关键词：共享、联通、融合和创新。联通是前台以及 中台之间的

联通，融合是前台流程和数据的融合，并以共享的方式支持前端一线业务的发展 和创新。

3.第3页 【高亮】

中台来源于平台，但中台和平台相比，它更多体现的是一种理念的转变，它主要体现在这三 个关

键能力上：对前台业务的快速响应能力；企业级复用能力；从前台、中台到后台的设 计、研发、

页面操作、流程服务和数据的无缝联通、融合能力

4.第3页 【高亮】

其中最关键的是快速响应能力和企业级的无缝联通和融合能力，尤其是对于跨业经营的超大 型企

业来说至关重要。

5.第7页 【高亮】

数据中台主要完成数据的融合和加工，萃取数据业务价值，支持业务创新，对外提供 数据共享服务

6.第7页 【高亮】

前台主要面向客户以及终端销售者，实现营销推广以及交易转化；中台主要面向运营人员， 完成

运营支撑；后台主要面向后台管理人员，实现流程审核、内部管理以及后勤支撑，比如 采购、人

力、财务和 OA 等系统。


# 10丨DDD、中台和微服务：它们是如何协作的？

1.第3页 【高亮】

中台的本质其实就是提炼各个业务板块的共同需求，进行业务和系统抽象，形成通用的可复 用的

业务模型，打造成组件化产品，供前台部门使用。前台要做什么业务，需要什么资源， 可以直接

找中台，不需要每次都去改动自己的底层。

2.第5页 【高亮】

中台业务建模的过程。 第一步：按照业务流程（通常适用于核心域）或者功能属性、集合（通常

适用于通用域或支 撑域），将业务域细分为多个中台，再根据功能属性或重要性归类到核心中台

或通用中台。 核心中台设计时要考虑核心竞争力，通用中台要站在企业高度考虑共享和复用能力

。 第二步：选取中台，根据用例、业务场景或用户旅程完成事件风暴，找出实体、聚合和限界 上

下文。依次进行领域分解，建立领域模型。

3.第5页 【高亮】

第三步：以主领域模型为基础，扫描其它中台领域模型，检查并确定是否存在重复或者需要 重组

的领域对象、功能，提炼并重构主领域模型，完成最终的领域模型设计。 第四步：选择其它主领

域模型重复第三步，直到所有主领域模型完成比对和重构。 第五步：基于领域模型完成微服务设

计，完成系统落地。




# 11丨DDD实践：如何用DDD重构中台业务模型？

1.第3页 【高亮】

中台是企业级能力复用平 台”，

2.第3页 【高亮】

中台的设计思想与“高内聚、低耦合”的设计原则是高度一致的

3.第3页 【下划线】

如何构建中台业务模型？

4.第3页 【高亮】

你可以选择两种建模策略：自顶向 下和自底向上的策略。具体采用哪种策略，你需要结合公司的

具体情况来分析

5.第4页 【高亮】

第一种策略是自顶向下。这种策略是先做顶层设计，从最高领域逐级分解为中台，分别建立 领域

模型，根据业务属性分为通用中台或核心中台。

6.第4页 【高亮】

自顶向下的策略适用于全新的应用系统建设，或旧系统推倒重建的情况。

7.第4页 【高亮】

第二种策略是自底向上。这种策略是基于业务和系统现状完成领域建模

8.第5页 【高亮】自底向上策略适用于遗留系统业务模型的演进式重构


# 12丨领域建模：如何用事件风暴构建领域模型？


1.第2页 【高亮】

事件风暴参与者会将自己的想法和意见写在即时贴上，并将贴纸贴在墙上的合适位置，我们 戏称

这个过程是“刷墙”。所以即时贴和水笔是必备材料，另外，你还可以准备一些胶带或 者磁扣，以

便贴纸随时能更换位置。

2.第3页 【高亮】

事件风暴的场地

3.第3页 【高亮】

你只需要一堵足够长的墙和足够大的空间就可以了。墙是用来贴纸的， 大空间可以让人四处走动

，方便合作。

4.第3页 【高亮】

事件风暴的发明者曾经建议要准备八米长的墙，这样设计就不会受到空间的限制了

5.第3页 【高亮】

事件风暴分析的关注点

6.第3页 【高亮】

在领域建模的过程中，我们需要重点关注这类业务的语言和行为。比如某些业务动作或行为 （事

件）是否会触发下一个业务动作，这个动作（事件）的输入和输出是什么？是谁（实 体）发出的

什么动作（命令），触发了这个动作（事件）…我们可以从这些暗藏的词汇中， 分析出领域模型

中的事件、命令和实体等领域对象

7.第3页 【高亮】领域建模的过程主要包括产品愿景、业务场景分析、领域建模和微服务拆分与设计这几个重 要阶段

8.第4页 【高亮】

产品愿景的参与角色：领域专家、业务需求方、产品经理、项目经理和开发经理

9.第5页 【高亮】

场景分析的参与角色：领域专家、产品经理、需求分析人员、架构师、项目经理、开发经理 和测

试经理。

10.第5页 【高亮】

场景分析时会产生很多的命令和领域事件

11.第6页 【高亮】

领域建模时，我们会根据场景分析过程中产生的领域对象，比如命令、事件等之间关系，找 出产

生命令的实体，分析实体之间的依赖关系组成聚合，为聚合划定限界上下文，建立领域 模型以及

模型之间的依赖。领域模型利用限界上下文向上可以指导微服务设计，通过聚合向 下可以指导聚

合根、实体和值对象的设计。

12.第6页 【高亮】

领域建模的参与角色：领域专家、产品经理、需求分析人员、架构师、项目经理、开发经理 和测

试经理

13.第6页 【高亮】

具体可以分为这样三步。 第一步：从命令和事件中提取产生这些行为的实体

14.第7页 【高亮】

第二步：根据聚合根的管理性质从七个实体中找出聚合根

15.第7页 【高亮】第三步：划定限界上下文，根据上下文语义将聚合归类

16.第8页 【高亮】

此在微 服务拆分与设计时，我们不能简单地将领域模型作为拆分微服务的唯一标准，它只能作为

微 服务拆分的一个重要依据。

17.第9页 【高亮】

除了考虑业 务职责单一外，我们还需要考虑将敏态与稳态业务的分离、非功能性需求（如弹性伸

缩要 求、安全性等要求）、团队组织和沟通效率、软件包大小以及技术异构等非业务因素

18.第9页 【高亮】

微服务的设计还需要考虑服务的粒度、分层、边界划分、依赖关系和集成关系

19.第9页 【高亮】

微服务设计建议参与的角色：领域专家、产品经理、需求分析人员、架构师、项目经理、开 发经

理和测试经理

20.第9页 【高亮】

即先有边界清晰的领域模型，才能设计出清晰的微服务 边界，



# 13丨代码模型（上）：如何使用DDD设计微服务代码模型？



1.第1页 【高亮】

只有建立了标准的微服务代码模型和代码规范后，我们才可以将领域对象所对应的代码对象 放在

合适的软件包的目录结构中。标准的代码模型可以让项目团队成员更好地理解代码，根 据代码规

范实现团队协作；还可以让微服务各层的逻辑互不干扰、分工协作、各据其位、各 司其职，避免

不必要的代码混淆。另外，标准的代码模型还可以让你在微服务架构演进时， 轻松完成代码重构。

2.第2页 【高亮】

用户接口层：面向前端提供服务适配，面向资源层提供资源适配。这一层聚集了接口适 配相关的

功能。

3.第3页 【高亮】

应用层职责：实现服务组合和编排，适应业务流程快速变化的需求。这一层聚集了应用 服务和事

件相关的功能。

4.第3页 【高亮】

领域层：实现领域的核心业务逻辑。这一层聚集了领域模型的聚合、聚合根、实体、值 对象、领

域服务和事件等领域对象，以及它们组合所形成的业务能力。 基础层：贯穿所有层，为各层提供

基础资源服务。这一层聚集了各种底层资源相关的服 务和能力。

5.第4页 【高亮】

Interfaces（用户接口层）：它主要存放用户接口层与前端交互、展现数据相关的代码

6.第4页 【高亮】

Application（应用层）：它主要存放应用层服务组合和编排相关的代码7.第4页 【高亮】

Domain（领域层）：它主要存放领域层核心业务逻辑相关的代码。领域层可以包含多个聚 合代

码包，它们共同实现领域模型的核心业务逻辑。聚合以及聚合内的实体、方法、领域服 务和事件

等代码会放在这一层目录里。